(function(){var u="0.3.2",j=window.jQuery||window.$||(window.$={}),f={parse:window.JSON&&(window.JSON.parse||window.JSON.decode)||String.prototype.evalJSON&&function(H){return String(H).evalJSON()}||j.parseJSON||j.evalJSON,stringify:Object.toJSON||window.JSON&&(window.JSON.stringify||window.JSON.encode)||j.toJSON};if(!f.parse||!f.stringify){throw new Error("No JSON support found, include //cdnjs.cloudflare.com/ajax/libs/json2/20110223/json2.js to page")}var m={__jstorage_meta:{CRC32:{}}},c={jStorage:"{}"},z=null,o=0,i=false,k={},E=false,A=0,s={},y=+new Date(),B,C={isXML:function(I){var H=(I?I.ownerDocument||I:0).documentElement;return H?H.nodeName!=="HTML":false},encode:function(I){if(!this.isXML(I)){return false}try{return new XMLSerializer().serializeToString(I)}catch(H){try{return I.xml}catch(J){}}return false},decode:function(I){var H=("DOMParser" in window&&(new DOMParser()).parseFromString)||(window.ActiveXObject&&function(K){var L=new ActiveXObject("Microsoft.XMLDOM");L.async="false";L.loadXML(K);return L}),J;if(!H){return false}J=H.call("DOMParser" in window&&(new DOMParser())||window,I,"text/xml");return this.isXML(J)?J:false}},D=function(){};function q(){var H=false;if("localStorage" in window){try{window.localStorage.setItem("_tmptest","tmpval");H=true;window.localStorage.removeItem("_tmptest")}catch(I){}}if(H){try{if(window.localStorage){c=window.localStorage;i="localStorage";A=c.jStorage_update}}catch(O){}}else{if("globalStorage" in window){try{if(window.globalStorage){c=window.globalStorage[window.location.hostname];i="globalStorage";A=c.jStorage_update}}catch(N){}}else{z=document.createElement("link");if(z.addBehavior){z.style.behavior="url(#default#userData)";document.getElementsByTagName("head")[0].appendChild(z);try{z.load("jStorage")}catch(M){z.setAttribute("jStorage","{}");z.save("jStorage");z.load("jStorage")}var L="{}";try{L=z.getAttribute("jStorage")}catch(K){}try{A=z.getAttribute("jStorage_update")}catch(J){}c.jStorage=L;i="userDataBehavior"}else{z=null;return}}}l();b();t("local");t("session");x();v();if("addEventListener" in window){window.addEventListener("pageshow",function(P){if(P.persisted){p()}},false)}}function t(O,Q){var H=false,N=0,K,L,M={};var P=Math.random();if(!Q&&typeof window[O+"Storage"]!="undefined"){return}if(O=="local"&&window.globalStorage){localStorage=window.globalStorage[window.location.hostname];return}if(i!="userDataBehavior"){return}if(Q&&window[O+"Storage"]&&window[O+"Storage"].parentNode){window[O+"Storage"].parentNode.removeChild(window[O+"Storage"])}L=document.createElement("button");document.getElementsByTagName("head")[0].appendChild(L);if(O=="local"){M=m}else{if(O=="session"){I()}}for(K in M){if(M.hasOwnProperty(K)&&K!="__jstorage_meta"&&K!="length"&&typeof M[K]!="undefined"){if(!(K in L)){N++}L[K]=M[K]}}L.length=N;L.key=function(T){var S=0,R;I();for(R in M){if(M.hasOwnProperty(R)&&R!="__jstorage_meta"&&R!="length"&&typeof M[R]!="undefined"){if(S==T){return R}S++}}};L.getItem=function(R){I();if(O=="session"){return M[R]}return j.jStorage.get(R)};L.setItem=function(R,S){if(typeof S=="undefined"){return}L[R]=(S||"").toString()};L.removeItem=function(R){if(O=="local"){return j.jStorage.deleteKey(R)}L[R]=undefined;H=true;if(R in L){L.removeAttribute(R)}H=false};L.clear=function(){if(O=="session"){window.name="";t("session",true);return}j.jStorage.flush()};if(O=="local"){D=function(R,S){if(R=="length"){return}H=true;if(typeof S=="undefined"){if(R in L){N--;L.removeAttribute(R)}}else{if(!(R in L)){N++}L[R]=(S||"").toString()}L.length=N;H=false}}function I(){if(O!="session"){return}try{M=f.parse(window.name||"{}")}catch(R){M={}}}function J(){if(O!="session"){return}window.name=f.stringify(M)}L.attachEvent("onpropertychange",function(R){if(R.propertyName=="length"){return}if(H||R.propertyName=="length"){return}if(O=="local"){if(!(R.propertyName in M)&&typeof L[R.propertyName]!="undefined"){N++}}else{if(O=="session"){I();if(typeof L[R.propertyName]!="undefined"&&!(R.propertyName in M)){M[R.propertyName]=L[R.propertyName];N++}else{if(typeof L[R.propertyName]=="undefined"&&R.propertyName in M){delete M[R.propertyName];N--}else{M[R.propertyName]=L[R.propertyName]}}J();L.length=N;return}}j.jStorage.set(R.propertyName,L[R.propertyName]);L.length=N});window[O+"Storage"]=L}function e(){var J="{}";if(i=="userDataBehavior"){z.load("jStorage");try{J=z.getAttribute("jStorage")}catch(I){}try{A=z.getAttribute("jStorage_update")}catch(H){}c.jStorage=J}l();b();v()}function x(){if(i=="localStorage"||i=="globalStorage"){if("addEventListener" in window){window.addEventListener("storage",p,false)}else{document.attachEvent("onstorage",p)}}else{if(i=="userDataBehavior"){setInterval(p,1000)}}}function p(){var H;clearTimeout(E);E=setTimeout(function(){if(i=="localStorage"||i=="globalStorage"){H=c.jStorage_update}else{if(i=="userDataBehavior"){z.load("jStorage");try{H=z.getAttribute("jStorage_update")}catch(I){}}}if(H&&H!=A){A=H;h()}},25)}function h(){var H=f.parse(f.stringify(m.__jstorage_meta.CRC32)),L;e();L=f.parse(f.stringify(m.__jstorage_meta.CRC32));var J,I=[],K=[];for(J in H){if(H.hasOwnProperty(J)){if(!L[J]){K.push(J);continue}if(H[J]!=L[J]&&String(H[J]).substr(0,2)=="2."){I.push(J)}}}for(J in L){if(L.hasOwnProperty(J)){if(!H[J]){I.push(J)}}}G(I,"updated");G(K,"deleted")}function G(M,N){M=[].concat(M||[]);if(N=="flushed"){M=[];for(var L in k){if(k.hasOwnProperty(L)){M.push(L)}}N="deleted"}for(var K=0,H=M.length;K<H;K++){if(k[M[K]]){for(var J=0,I=k[M[K]].length;J<I;J++){k[M[K]][J](M[K],N)}}}}function n(){var H=(+new Date()).toString();if(i=="localStorage"||i=="globalStorage"){c.jStorage_update=H}else{if(i=="userDataBehavior"){z.setAttribute("jStorage_update",H);z.save("jStorage")}}p()}function l(){if(c.jStorage){try{m=f.parse(String(c.jStorage))}catch(H){c.jStorage="{}"}}else{c.jStorage="{}"}o=c.jStorage?String(c.jStorage).length:0;if(!m.__jstorage_meta){m.__jstorage_meta={}}if(!m.__jstorage_meta.CRC32){m.__jstorage_meta.CRC32={}}}function r(){a();try{c.jStorage=f.stringify(m);if(z){z.setAttribute("jStorage",c.jStorage);z.save("jStorage")}o=c.jStorage?String(c.jStorage).length:0}catch(H){}}function w(H){if(!H||(typeof H!="string"&&typeof H!="number")){throw new TypeError("Key name must be string or numeric")}if(H=="__jstorage_meta"){throw new TypeError("Reserved key name")}return true}function b(){var N,I,L,J,K=Infinity,M=false,H=[];clearTimeout(B);if(!m.__jstorage_meta||typeof m.__jstorage_meta.TTL!="object"){return}N=+new Date();L=m.__jstorage_meta.TTL;J=m.__jstorage_meta.CRC32;for(I in L){if(L.hasOwnProperty(I)){if(L[I]<=N){delete L[I];delete J[I];delete m[I];M=true;H.push(I)}else{if(L[I]<K){K=L[I]}}}}if(K!=Infinity){B=setTimeout(b,K-N)}if(M){r();n();G(H,"deleted")}}function v(){if(!m.__jstorage_meta.PubSub){return}var H,J=y;for(var I=len=m.__jstorage_meta.PubSub.length-1;I>=0;I--){H=m.__jstorage_meta.PubSub[I];if(H[0]>y){J=H[0];d(H[1],H[2])}}y=J}function d(J,K){if(s[J]){for(var I=0,H=s[J].length;I<H;I++){s[J][I](J,f.parse(f.stringify(K)))}}}function a(){if(!m.__jstorage_meta.PubSub){return}var J=+new Date()-2000;for(var I=0,H=m.__jstorage_meta.PubSub.length;I<H;I++){if(m.__jstorage_meta.PubSub[I][0]<=J){m.__jstorage_meta.PubSub.splice(I,m.__jstorage_meta.PubSub.length-I);break}}if(!m.__jstorage_meta.PubSub.length){delete m.__jstorage_meta.PubSub}}function g(H,I){if(!m.__jstorage_meta){m.__jstorage_meta={}}if(!m.__jstorage_meta.PubSub){m.__jstorage_meta.PubSub=[]}m.__jstorage_meta.PubSub.unshift([+new Date,H,I]);r();n()}function F(M,I){var H=M.length,L=I^H,K=0,J;while(H>=4){J=((M.charCodeAt(K)&255))|((M.charCodeAt(++K)&255)<<8)|((M.charCodeAt(++K)&255)<<16)|((M.charCodeAt(++K)&255)<<24);J=(((J&65535)*1540483477)+((((J>>>16)*1540483477)&65535)<<16));J^=J>>>24;J=(((J&65535)*1540483477)+((((J>>>16)*1540483477)&65535)<<16));L=(((L&65535)*1540483477)+((((L>>>16)*1540483477)&65535)<<16))^J;H-=4;++K}switch(H){case 3:L^=(M.charCodeAt(K+2)&255)<<16;case 2:L^=(M.charCodeAt(K+1)&255)<<8;case 1:L^=(M.charCodeAt(K)&255);L=(((L&65535)*1540483477)+((((L>>>16)*1540483477)&65535)<<16))}L^=L>>>13;L=(((L&65535)*1540483477)+((((L>>>16)*1540483477)&65535)<<16));L^=L>>>15;return L>>>0}j.jStorage={version:u,set:function(I,J,H){w(I);H=H||{};if(typeof J=="undefined"){this.deleteKey(I);return J}if(C.isXML(J)){J={_is_xml:true,xml:C.encode(J)}}else{if(typeof J=="function"){return undefined}else{if(J&&typeof J=="object"){J=f.parse(f.stringify(J))}}}m[I]=J;m.__jstorage_meta.CRC32[I]="2."+F(f.stringify(J));this.setTTL(I,H.TTL||0);D(I,J);G(I,"updated");return J},get:function(H,I){w(H);if(H in m){if(m[H]&&typeof m[H]=="object"&&m[H]._is_xml){return C.decode(m[H].xml)}else{return m[H]}}return typeof(I)=="undefined"?null:I},deleteKey:function(H){w(H);if(H in m){delete m[H];if(typeof m.__jstorage_meta.TTL=="object"&&H in m.__jstorage_meta.TTL){delete m.__jstorage_meta.TTL[H]}delete m.__jstorage_meta.CRC32[H];D(H,undefined);r();n();G(H,"deleted");return true}return false},setTTL:function(I,H){var J=+new Date();w(I);H=Number(H)||0;if(I in m){if(!m.__jstorage_meta.TTL){m.__jstorage_meta.TTL={}}if(H>0){m.__jstorage_meta.TTL[I]=J+H}else{delete m.__jstorage_meta.TTL[I]}r();b();n();return true}return false},getTTL:function(I){var J=+new Date(),H;w(I);if(I in m&&m.__jstorage_meta.TTL&&m.__jstorage_meta.TTL[I]){H=m.__jstorage_meta.TTL[I]-J;return H||0}return 0},flush:function(){m={__jstorage_meta:{CRC32:{}}};t("local",true);r();n();G(null,"flushed");return true},storageObj:function(){function H(){}H.prototype=m;return new H()},index:function(){var H=[],I;for(I in m){if(m.hasOwnProperty(I)&&I!="__jstorage_meta"){H.push(I)}}return H},storageSize:function(){return o},currentBackend:function(){return i},storageAvailable:function(){return !!i},listenKeyChange:function(H,I){w(H);if(!k[H]){k[H]=[]}k[H].push(I)},stopListening:function(I,J){w(I);if(!k[I]){return}if(!J){delete k[I];return}for(var H=k[I].length-1;H>=0;H--){if(k[I][H]==J){k[I].splice(H,1)}}},subscribe:function(H,I){H=(H||"").toString();if(!H){throw new TypeError("Channel not defined")}if(!s[H]){s[H]=[]}s[H].push(I)},publish:function(H,I){H=(H||"").toString();if(!H){throw new TypeError("Channel not defined")}g(H,I)},reInit:function(){e()}};q()})();